# spring-grpc
A simple example of gRPC communication between two servers with Spring boot.<br>
The gRPC uses Protocol Buffers to communicate in a serialized byte stream over the HTTP/2 layer,<br>
making it lighter and faster than JSON-based communication. (e.g. REST)<br>
So, there are advantages of reduced latency and performance to handle more traffic.
<br><br>

## What is gRPC?
gRPC is Google's remote procedure call (RPC) system that uses tcp/ip and HTTP/2 protocols.<br>
RPC is a protocol that easily calls the service of another server as if it were an internal service call.<br>
Since it is independent of language between function calls, it can improve distributed application development productivity.
<br>
<img src="https://user-images.githubusercontent.com/17774927/170109844-cd9ccc79-f923-4051-81e1-92460322e788.png" alt="https://stackoverflow.com/questions/37622540/web-client-communicate-with-grpc-server">

## Communication types
When there are N requests, only `async` is supported,<br>
and `future` is not supported when there are N responses.<br>
So there are seven things in total.
<br>
<table>
  <thead>
    <tr>
      <td></td>
      <td>unary</td>
      <td>server stream (N responses)</td>
      <td>client stream (N requests)</td>
      <td>bi-stream(N requests & responses)</td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>blocking</td>
      <td>o</td>
      <td>o</td>
      <td>x</td>
      <td>x</td>
    </tr>
    <tr>
      <td>async</td>
      <td>o</td>
      <td>o</td>
      <td>o</td>
      <td>o</td>
    </tr>
    <tr>
      <td>future</td>
      <td>o</td>
      <td>x</td>
      <td>x</td>
      <td>x</td>
    </tr>
  </tbody>
</table>
<br>

## Usage
1. Build `.proto` file first.
    
        cd grpc-lib && ./gradlew build
        
    <img src="https://user-images.githubusercontent.com/17774927/170113055-a81ac63f-a9ca-4ba0-b792-1d1c52ae1b18.png">
    <br>If the build is successful, you can see that the java file(SimpleGrpc) has been created as above.<br>
          
2. Build & Run the `grpc-server` and `grpc-client`.
<br>

## API
For testing, I created the rest api controller.<br>
You can check the gRPC communication using the apis below.

- blocking call
    
      # unary
      curl "http://localhost:8081/blocking/unary?name=Hello" -s
    
      # server stream
      curl "http://localhost:8081/blocking/serverStream?name=World" -s
    
- async call
    
      # unary
      curl "http://localhost:8081/async/unary?name=Hello" -s
      
      # server stream
      curl "http://localhost:8081/async/serverStream?name=World" -s
      
      # client stream
      curl "http://localhost:8081/async/clientStream?name=Hello,World" -s
      
      # bi-stream
      curl "http://localhost:8081/async/biStream?name=Hello,World,gRPC" -s

- future call

      # unary
      curl "http://localhost:8081/future/unary?name=Hello" -s
<img src="https://user-images.githubusercontent.com/17774927/170116132-8a2248ad-5ed4-4572-8a9d-1b3f2ff7acd5.png">

### Be careful!
You need to be aware that using functions generated by protoc-gen-grpc-java can cause `NullPointerException`.
<br><br>

## References
- <a href="https://github.com/yidongnan/grpc-spring-boot-starter">https://github.com/yidongnan/grpc-spring-boot-starter</a>
- <a href="https://qwer9412.tistory.com/40?category=926343">https://qwer9412.tistory.com/40?category=926343</a>
